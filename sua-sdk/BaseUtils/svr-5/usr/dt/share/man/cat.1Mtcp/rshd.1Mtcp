

rshd(1Mtcp)                                           rshd(1Mtcp)

SSyynnooppssiiss
       in.rshd host.port

DDeessccrriippttiioonn
       The  rshd command is the server for the and programs.  The
       server provides remote execution facilities with authenti-
       cation based on privileged port numbers.

   FFiilleess
   DDiiaaggnnoossttiiccss
       The following diagnostic messages are returned on the con-
       nection associated with the stderr, after which  any  net-
       work  connections  are closed.  An error is indicated by a
       leading byte with a value of 1 (0 is returned  in  step  9
       below upon successful completion of all the steps prior to
       the command execution).  The  name  of  the  user  on  the
       client's  machine  is longer than 16 characters.  The name
       of the user on the remote machine is longer than 16  char-
       acters.   The  command line passed exceeds the size of the
       argument list (as configured into the system).   No  entry
       in  the  host  name  database  existed  for  the  client's
       machine.   No  password  file  entry  for  the  user  name
       existed.   The  authentication  procedure  described below
       failed.  The pipe needed for the stderr was  not  created.
       A fork by the server failed.

UUssaaggee
       rshd is invoked by each time a shell service is requested,
       and executes the following protocol: The server checks the
       client's source port.  If the port is not in the range
       0-1023,  the  server  aborts  the connection.  The clients
       host address (in hex) and port number (in decimal) are the
       argument passed to rshd.  The server reads characters from
       the socket up to a null (\0) byte.  The  resultant  string
       is interpreted as an ASCII number, base 10.  If the number
       received in step 1 is non-zero, it is interpreted  as  the
       port  number  of  a  secondary  stream  to be used for the
       stderr.  A second connection is then created to the speci-
       fied  port  on  the  client's machine.  The source port of
       this second connection is also in the range  0-1023.   The
       server checks the client's source address.  If the address
       is associated with a host for which no corresponding entry
       exists  in  the host name data base (see the server aborts
       the connection.  A null terminated user name of at most 16
       characters  is retrieved on the initial socket.  This user
       name is interpreted as a  user  identity  to  use  on  the
       server's  machine.  A null terminated user name of at most
       16 characters is retrieved on the  initial  socket.   This
       user  name  is  interpreted  as  the  user identity on the
       client's machine.  A null terminated command to be  passed
       to a shell is retrieved on the initial socket.  The length
       of the command is limited by the upper bound on  the  size
       of  the  system's  argument list.  rshd then validates the
       user according to the following steps.   The  remote  user

                                                                1

rshd(1Mtcp)                                           rshd(1Mtcp)

       name is looked up in the password file and a chdir is per-
       formed to the user's home directory.   If  the  lookup  or
       fails,  the connection is terminated.  If the chdir fails,
       it does a chdir to / (root).  If the user is not root (UID
       is  0),  the file /etc/hosts.equiv is consulted for a list
       of hosts considered equivalent.  If the client's host name
       is  present in this file, the authentication is considered
       successful.  If the lookup fails, or the user is a  privi-
       leged user, then the file .rhosts in the home directory of
       the remote user is checked for the machine name and  iden-
       tity  of the user on the client's machine.  If this lookup
       fails, the connection  is  terminated.   A  null  byte  is
       returned  on the connection associated with the stderr and
       the command line is passed to the normal  login  shell  of
       the  user.   The  shell  inherits  the network connections
       established by rshd.

RReeffeerreenncceess
NNoottiicceess
       The  authentication  procedure  used  here   assumes   the
       integrity  of  each  client  machine  and  the  connecting
       medium.  This is insecure, but is useful  in  an  ``open''
       environment.

       If  a remote user does not have a home directory, the root
       directory (/) becomes the user's home directory.

       A facility to allow all data  exchanges  to  be  encrypted
       should be present.

                                                                2

