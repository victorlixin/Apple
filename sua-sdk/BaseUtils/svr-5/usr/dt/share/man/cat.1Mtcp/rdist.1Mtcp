

rdist(1Mtcp)                                         rdist(1Mtcp)

SSyynnooppssiiss
       rdist [-nqbRhivwyD] [-f distfile] [-d var=value] [-m host]
       [name...]

       rdist [-nqbRhivwyD] -c name...  [login@]host[:dest]

DDeessccrriippttiioonn
       The rdist command maintains identical copies of files over
       multiple  hosts.  It preserves the owner, group, mode, and
       mtime of files if possible and can  update  programs  that
       are executing.

FFiilleess
       input command file temporary file for update lists

DDiiaaggnnoossttiiccss
       A  complaint  about  mismatch of rdist version numbers may
       really stem from some problem with  starting  your  shell,
       for example, when you are in too many groups.

UUssaaggee
       rdist  reads commands from distfile to direct the updating
       of files and/or directories.

   OOppttiioonnss
       Options specific to the first form of  the  rdist  command
       are:  If distfile is `-', the standard input is used.  Use
       the specified distfile.

       If either the -f or `-' option  is  not  specified,  rdist
       looks  first  for  distfile,  then  Distfile to use as the
       input.  If no names are specified  on  the  command  line,
       rdist  will update all of the files and directories listed
       in distfile.  Otherwise, the argument is taken to  be  the
       name  of a file to be updated or the label of a command to
       execute. If label and filenames conflict, it is assumed to
       be a label.  These may be used together to update specific
       files using specific commands.

       Options specific to the second form of the  rdist  command
       are:  Forces rdist to interpret the remaining arguments as
       a small distfile.

       The equivalent distfile is  as  follows.   (name  ...)  ->
       [login@] host      install [dest];

       Options  common  to  both  forms of the rdist command are:
       Define var to have value.  The -d option is used to define
       or  override  variable definitions in the distfile.  value
       can be the empty string, one name, or a list of names sur-
       rounded  by  parentheses  and  separated  by  tabs  and/or
       spaces.  Limit which machines are to be updated.  Multiple
       -m  arguments can be given to limit updates to a subset of
       the hosts listed the distfile.  Print the commands without

                                                                1

rdist(1Mtcp)                                         rdist(1Mtcp)

       executing  them. This option is useful for debugging dist-
       file.  Quiet mode.  Files that are being modified are nor-
       mally  printed  on  standard  output.   The -q option sup-
       presses this.  Remove extraneous files.  If a directory is
       being  updated,  any  files  that exist on the remote host
       that do not exist in the  master  directory  are  removed.
       This  is  useful for maintaining truly identical copies of
       directories.  Follow symbolic links.  Copy the  file  that
       the  link points to rather than the link itself.  This has
       no effect on  machines  without  symbolic  links.   Ignore
       unresolved links.  rdist will normally try to maintain the
       link structure of files being  transferred  and  warn  the
       user  if  all  the links cannot be found.  Verify that the
       files are up to date on all the hosts.  Any files that are
       out of date will be displayed but no files will be changed
       nor any mail sent.  Whole mode.   The  whole  filename  is
       appended  to  the  destination  directory name.  Normally,
       only the last component of a name is  used  when  renaming
       files.   This will preserve the directory structure of the
       files being copied instead  of  flattening  the  directory
       structure.   For example, renaming a list of files such as
       (dir1/file1  dir2/file2)  to  dir3  would   create   files
       dir3/dir1/file1  and dir3/dir2/file2 instead of dir3/file1
       and dir3/file2.  Younger mode.  Files are normally updated
       if  their  mtime  and  size  (see disagree.  The -y option
       causes rdist not to update files that are younger than the
       master  copy.  This can be used to prevent newer copies on
       other hosts from being replaced.   A  warning  message  is
       printed  for  files  which are newer than the master copy.
       Binary comparison.  Perform a binary comparison and update
       files  if  they  differ  rather  than  comparing dates and
       sizes.  Enable debugging.

   DDiissttrriibbuuttiioonn ffiillee
       distfile contains a sequence of entries that  specify  the
       files to be copied, the destination hosts, and what opera-
       tions to perform to do the updating.  Each entry  has  one
       of   the  following  formats:  variable_name  =  name_list
       [label:]source_list   ->   destination_list   command_list
       [label:]source_list :: time_stamp file command_list

       The first format is used for defining variables.  The sec-
       ond format is used for distributing files to other  hosts.
       The  third  format  is used for making lists of files that
       have been changed since some given date.  The  source_list
       specifies  a list of files and/or directories on the local
       host which are to be used as the master copy for distribu-
       tion.   The destination_list is the list of hosts to which
       these files are to be copied.  Each  file  in  the  source
       list  is  added to a list of changes if the file is out of
       date on the host which is being updated (second format) or
       the file is newer than the time stamp file (third format).

       Labels are optional.  They are used to identify a  command

                                                                2

rdist(1Mtcp)                                         rdist(1Mtcp)

       for partial updates.

       Newlines, tabs, and blanks are only used as separators and
       are otherwise ignored.  Comments begin with # and end with
       a newline.

       Variables  to  be  expanded  begin  with $ followed by one
       character or a name enclosed  in  curly  braces  (see  the
       examples at the end).

       The  source  and destination lists have either of the fol-
       lowing formats: name ( <zero or more  names  separated  by
       white-space> )

       The shell meta-characters [, ], {, }, *, and ?  are recog-
       nized and expanded (on the local host only)  in  the  same
       way  as They can be escaped with a backslash.  The ~ char-
       acter is also expanded in the same way as but is  expanded
       separately  on  the local and destination hosts.  When the
       -w option is used with a  filename  that  begins  with  ~,
       everything  except  the  home directory is appended to the
       destination name.  Filenames which do not begin with /  or
       ~  use  the  destination user's home directory as the root
       directory for the rest of the filename.

       The command list consists of zero or more commands of  the
       following format: install        options   opt_dest_name ;
       notify         name_list ;      except         name_list ;
       except_pat          pattern_list   ;
       special        name_list string ;

       The install command is used to  copy  out  of  date  files
       and/or  directories.   Each  source file is copied to each
       host in the destination list.  Directories are recursively
       copied  in  the  same  way.   opt_dest_name is an optional
       parameter to rename files.  If no install command  appears
       in  the command list or the destination name is not speci-
       fied, the source filename is  used.   Directories  in  the
       path  name  will  be  created  if they do not exist on the
       remote host.   To  help  prevent  disasters,  a  non-empty
       directory  on  a target host will never be replaced with a
       regular file or a symbolic link.  However,  under  the  -R
       option a non-empty directory will be removed if the corre-
       sponding filename is completely absent on the master host.
       The  options  are  -R, -h, -i, -v, -w, -y, and -b and have
       the same semantics as options on the command  line  except
       they  only  apply  to  the  files in the source list.  The
       login name used on the destination host is the same as the
       local  host  unless  the destination name is of the format
       login@host.

       The notify command is used  to  mail  the  list  of  files
       updated  (and  any  errors  that may have occurred) to the
       listed  names.   If  no  @  appears  in  the   name,   the

                                                                3

rdist(1Mtcp)                                         rdist(1Mtcp)

       destination  host  is  appended  to the name (for example,
       name1@host, name2@host, ...).

       The except command is used to  update  all  files  in  the
       source list except for those listed in name_list.  This is
       usually used to copy everything in a directory except cer-
       tain files.

       The  except_pat  command is like the except command except
       that pattern_list is a list of  regular  expressions  (see
       for  details).  If one of the patterns matches some string
       within a filename, that file will be ignored.   Note  that
       since \ is a quote character, it must be doubled to become
       part of the regular expression.  Variables are expanded in
       pattern_list  but  not shell file pattern matching charac-
       ters.  To include a $, it must be escaped with \.

       The special command is used to specify commands  that  are
       to  be  executed  on  the  remote  host  after the file in
       name_list is updated or installed.  If  the  name_list  is
       omitted then the shell commands will be executed for every
       file updated or installed.  The shell variable FILE is set
       to  the  current filename before executing the commands in
       string.  string starts and ends with " and can cross  mul-
       tiple  lines  in distfile.  Multiple commands to the shell
       should be separated by ;.  Commands are  executed  in  the
       user's home directory on the host being updated.  The spe-
       cial command can be used to rebuild private databases, and
       so on after a program has been updated.

WWaarrnniinnggss
       rdist  on  older  versions  of BSD  systems had rdist hard
       coded to point to /usr/ucb/rdist.

       Source files must reside on the local host where rdist  is
       executed.

       There  is  no  easy way to have a special command executed
       after all files in a directory have been updated.

       rdist aborts on files which have a negative mtime  (before
       January 1, 1970).

RReeffeerreenncceess
NNoottiicceess
       Variable expansion only works for name lists; there should
       be a general macro facility.

       There should be a force option  to  allow  replacement  of
       non-empty  directories  by  regular  files or symlinks.  A
       means of updating file modes and owners of otherwise iden-
       tical files is also needed.

                                                                4

rdist(1Mtcp)                                         rdist(1Mtcp)

EExxaammpplleess
       The  following  is  a  small  distfile  example: HOSTS = (
       matisse root@arpa )

       FILES    =    (    /bin    /lib    /usr/bin     /usr/games
            /usr/include/{*.h,{stand,sys,vax*,pas-
       cal,machine}/*.h}       /usr/lib  /usr/man/man?   /usr/ucb
       /usr/local/rdist )

       EXLIB  = ( Mail.rc aliases aliases.dir aliases.pag crontab
       dshrc      sendmail.cf sendmail.fc sendmail.hf sendmail.st
       uucp vfont )

       ${FILES}   ->   ${HOSTS}       install  -R  ;       except
       /usr/lib/${EXLIB} ;      except /usr/games/lib ;      spe-
       cial /usr/lib/sendmail "/usr/lib/sendmail -bz" ;

       srcs:   /usr/src/bin  ->  arpa       except_pat  (  \\.o\$
       /SCCS\$ ) ;

       IMAGEN = (ips dviimp catdvi)

       imagen:   /usr/local/${IMAGEN}   ->   arpa         install
       /usr/local/lib ;      notify ralph ;

       ${FILES} :: stamp.cory      notify root@cory ;

                                                                5

