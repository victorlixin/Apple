

auditon(1M)                                           auditon(1M)

SSyynnooppssiiss
       auditon

DDeessccrriippttiioonn
       The  auditon  shell level command allows the administrator
       with the appropriate privileges to enable  auditing.   The
       privileges  required are audit, dacread, macwrite and set-
       plevel.

       When auditon is invoked, it retrieves the  default  values
       for  the  AUDIT_LOGERR,  AUDIT_LOGFULL,  and AUDIT_DEFPATH
       parameters from the /etc/default/audit file.  If access to
       the  file  is denied or if any of the key words is missing
       or invalid, an error message is  printed  (see  ``Diagnos-
       tics'').   The  default  value  for  the  AUDIT_LOGERR and
       AUDIT_LOGFULL parameters is DISABLE.   The  default  value
       for the AUDIT_DEFPATH parameter is /var/audit.

       If  the  event  log file is a regular file, the AUDIT_NODE
       parameter is evaluated.  If the  value  of  AUDIT_NODE  is
       longer  than  7  characters or contains a slash, it is not
       used and no node name is appended to the  log  file  name.
       If the value of AUDIT_NODE is valid, it is appended to the
       log file name.

       If the value of AUDIT_LOGFULL  is  SWITCH,  the  AUDIT_PGM
       parameter  is  evaluated.   If  the  value of AUDIT_PGM is
       valid, it is used as the absolute pathname of a program to
       execute  when  a log switch occurs.  The AUDIT_DEFPATH and
       AUDIT_NODE parameters are also evaluated, and their values
       used  for  the  alternate log file name and alternate node
       name.

       The auditlog command may be used to override all  but  the
       AUDIT_LOGERR parameter.

       When  auditon  is  invoked, it initializes the audit event
       log file.  If auditon is invoked when the  maximum  number
       of  audit  files  already  exist, an error message is dis-
       played (see  ``Diagnostics'').   In  such  cases,  editing
       /etc/default/audit  to  change the AUDIT_DEFPATH parameter
       controlling which directory log files will be  placed  may
       be helpful.

       If  the event log file cannot be accessed an error message
       is displayed (see ``Diagnostics'').  When the auditon com-
       mand completes successfully, the following message is dis-
       played: Auditing enabled filename

       In this case, filename is the name of the audit log  file.

       The auditon command invokes the auditmap command to create
       the audit map files.

                                                                1

auditon(1M)                                           auditon(1M)

       Auditing remains enabled while the system is running until
       the  auditoff  command is executed, or the log full condi-
       tion of DISABLE or SHUTDOWN occurs, or an audit  error  is
       encountered.

       If  the  &lkpou8;  is installed, note that auditing cannot
       provide audit records for &lx;  mode  activities  on  your
       system.  You must either accept that &lx; mode events will
       not be audited, or disable the &lkp;.  If the auditon com-
       mand  is issued without a -e lkp or -d lkp option, you are
       prompted as follows: [1] Allow Linux  mode  activities  to
       continue  but  with no audit records [2] Disable all Linux
       mode activities now (Linux binaries will coredump,
           auditing is enabled and complete).  [3] Abort auditon,
       make no change to audit or Linux mode at this time.
              Choose 1, 2, or 3:"

       The  auditon command has the following options: The -e lkp
       option enables auditing for  mode and  permits  &lx;  mode
       activities  if  the  &lkpou8;  is installed, but &lx; mode
       events are not audited.  The -d lkp option enables  audit-
       ing  but  completely disables the &lkpou8;. You might want
       to warn users before disabling the &lkp;.  If  &lx;  bina-
       ries  are  running  when  the &lkp; is disabled, they will
       core dump.

FFiilleess
       /etc/default/audit  /var/audit/MMDD###   /etc/init.d/audit
       /etc/rc2.d/S02audit

DDiiaaggnnoossttiiccss
       On successful completion, the auditon command exits with a
       value of zero (0).  If there is an error,  it  exits  with
       one  of  the following values and prints the corresponding
       error message: usage: auditon

       Invalid command syntax.  system service not installed

       The audit package is not installed.  Permission denied

       Failure because  of  insufficient  privilege.   auditlog()
       failed ALOGGET, errno = errno

       Failure  occurred while getting audit log file attributes.
       auditlog() failed ALOGSET, errno = errno

       Failure occurred while setting audit log file  attributes.
       auditctl() failed ASTATUS, errno = errno

       Failure  occurred while retrieving the status of auditing.
       cannot access event log current log file

       Failure occurred  while  attempting  to  enable  auditing.
       Internal error, errno = errno

                                                                2

auditon(1M)                                           auditon(1M)

       Failure occurred while attempting to enable auditing.  the
       maximum (999) number of audit event log files for a  given
       day exist

       The  maximum number of audit event log files exist, audit-
       ing is not enabled.  auditing  abnormally  terminated  log
       file

       Before  command  completion  auditing  was  terminated  by
       another  process.   unable  to  malloc  space  argvtostr()
       failed function name failed, errno = error

       Failure  occurred while accessing level information.  exec
       of program name failed fork() failed

       The  following  warning  messages  may  be  printed:   The
       /etc/default/audit  file cannot be accessed.  Default val-
       ues described in the DESCRIPTION section are used.  Audit-
       ing  is  enabled.   Auditing  is  enabled, however failure
       occurred  when  retrieving  audit  log  attributes  before
       changing owner/group of audit log file.

RReeffeerreenncceess

                                                                3

