

auditmap(1M)                                         auditmap(1M)

SSyynnooppssiiss
       auditmap  [-m dirname]

DDeessccrriippttiioonn
       The  auditmap  shell level command allows an administrator
       with the appropriate privileges to create  and  write  the
       audit  map  files.   The  privileges  required  are audit,
       dacread, macwrite and setplevel.  The auditmap command  is
       invoked  from the auditon command and may also be directly
       invoked by the auditing administrator.

       The  default  directory  for  the  audit  map  file(s)  is
       /var/audit/auditmap/.   The  -m  option allows the user to
       choose a directory where the audit  map  file(s)  will  be
       stored.   If  the directory, dirname, does not exist or is
       not writable, an error message is displayed  (see  ``Diag-
       nostics'').

       In  a  base  system,  the  auditmap  command  creates  the
       auditmap file.  This  file  contains  file  identification
       information and six maps: file-identification: audit soft-
       ware version, timezone  information,  privilege  mechanism
       information,  system  name,  machine  node name, operating
       system release and version, and  machine  type  all  login
       names  and  their  corresponding  uids all group names and
       their gids including multiple groups all event type  names
       and  their  corresponding  event  type  numbers  all event
       classes and their corresponding event types all  privilege
       names  and  their  corresponding  numbers  all system call
       names and their corresponding  numbers  If  the  Mandatory
       Access  Control  (MAC)  feature  is  installed,  the Level
       Translation Data Base (LTDB) is created in addition to the
       auditmap  file.   The  LTDB consists of the following four
       separate files: If the audit map  file(s)  already  exist,
       under the default directory or the -m specified directory,
       they will be renamed.  The existing auditmap file and each
       of  the  existing  LTDB  files will be prefixed with an o.
       The new audit map file and the LTDB  files  will  then  be
       created.

       File  locking mechanisms are in place to prevent file cor-
       ruption during concurrent invocations of auditmap.

FFiilleess
       /var/audit/auditmap/auditmap   /etc/security/audit/classes
       Additional   files   if  the  MAC  feature  is  installed:
       /var/audit/auditmap/ltf.alias  /var/audit/auditmap/ltf.cat
       /var/audit/auditmap/ltf.class
       /var/audit/auditmap/lid.internal                /etc/secu-
       rity/mac/ltf.alias   /etc/security/mac/ltf.cat  /etc/secu-
       rity/mac/ltf.class /etc/security/mac/lid.internal

DDiiaaggnnoossttiiccss
       On successful completion, the auditmap command exits  with

                                                                1

auditmap(1M)                                         auditmap(1M)

       a  value  of zero (0).  If there are errors, it exits with
       one of the following values and prints  the  corresponding
       error message: usage auditmap [-m dirname]

       Invalid command syntax.  system service not installed

       The audit package is not installed.  Permission denied

       Failure  because  of insufficient privilege.  Invalid full
       path or pathname dirname specified

       The directory specified as an argument to  the  -m  option
       does  not exist.  filename is not writable filename is not
       readable

       Unable  to  open  a  master  LTDB  file.   fcntl()  failed
       auditctl() failed ASTATUS

       Failure  occurred  while retrieving auditing status.  mal-
       loc() failed  argvtostr()  failed  function  name  failed,
       errno = error

       Failure  occurred  while accessing level information.  The
       following warning messages may be printed:

       The user, group, privilege, or class map was  not  created
       (for  example,  if  the  user information is incomplete or
       missing, the warning printed is: UID map  not  written  to
       audit  map file /var/audit/auditmap/auditmap) Or, a local-
       ized copy of a master LTDB file was not created (for exam-
       ple, the /etc/security/mac/lid.internal file was not writ-
       ten to audit map  file  /var/audit/auditmap/lid.internal).
       Unable  to place lock on file.  Unable to rename the local
       audit map file.

RReeffeerreenncceess

                                                                2

