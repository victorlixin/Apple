

auditset(1M)                                         auditset(1M)

SSyynnooppssiiss
       auditset  [-d  [-u  user[,.  .  .] | -a]] auditset [-d [-u
       user[,. . .] | -a] [-m]]

       auditset [-s [operator]event[,. . .]]
            [-e[operator]event[,. . .] -u user[,. . .]|-a] audit-
       set [-s [operator]event[,. . .]]
            [-e[operator]event[,. . .] -u user[,. . .]|-a]
            [-o [operator]event[,. . .]]
            [-r [-]levelmin-levelmax] [-l [+|-]level]

DDeessccrriippttiioonn
       The  auditset shell level command allows the administrator
       with the appropriate privileges to set or display the sys-
       tem  and  user  audit  criteria.   system, user and object
       level audit criteria.  The privileges required are  audit,
       dacread, macread and setplevel.

       To  set  or  display  user auditing criteria the specified
       user(s) must be active.  The -o, -l, -r,  and  -m  options
       are  only  valid  if  the Mandatory Access Control feature
       (MAC) is installed.  If no options  are  supplied  on  the
       command  line, then the System and User audit criteria are
       displayed.  If the MAC feature is installed, object  level
       audit criteria are also displayed.  (Object level informa-
       tion is only displayed if the MAC feature is installed.)

       The event input list must be separated by commas, and  can
       be  the  name  of  an  event  class  or event type.  Event
       classes are  defined  in  the  /etc/security/audit/classes
       system  file.   Additionally,  all and none may be used as
       event keywords.  For the system and  user  audit  criteria
       the  keyword  none is defined to be the set of fixed event
       types and the keyword all is defined to be the set of  all
       fixed  and  pre-selectable  event  types.   For the object
       audit criteria the keyword none is  defined  as  no  event
       types  and the keyword all is defined to be the set of all
       pre-selectable object event types.  Keywords  may  not  be
       intermixed  with  event  classes  or event types.  You may
       specify only one keyword with each option;  you  may  not,
       for  example,  specify  both  all  and none for the system
       audit criteria.

       The user input list must be separated by commas,  and  can
       be specified by either login name or uid.  (Note: auditing
       is based on real uid).

       Only one operator may be specified per option on the  com-
       mand  line.   Operators will be ignored when used with the
       keywords all and none.  The following are the valid opera-
       tor  values:  Replace  the  current  auditable  event(s) ,
       level, or level range with the specified input.   Add  the
       specified auditable event(s) or level to the current audit
       criteria.  Delete the specified auditable event(s) , level

                                                                1

auditset(1M)                                         auditset(1M)

       or  level  range  from  the  current  audit criteria.  All
       auditable events except those specified replace  the  cur-
       rent auditable events.

       The  following  are the valid command line options.  If no
       other options are given, display the current system  audit
       criteria in the format: System Audit Criteria:
            system:  all  |  none | events[,. . .]  The -u and -a
       options are modifiers to the -d option and the -e  option.
       The -u option is used to request a specific active user or
       a list of active users.  The -a option is used to  request
       all currently active users.  The -u and -a options can not
       be used on the same command line.  When used with  the  -e
       option  user  audit criteria is set (see explanation of -e
       option).  When used with the -d option, the  system  audit
       criteria is displayed, followed by the user audit criteria
       for the given user(s).  The format for  the  system  audit
       criteria is given under the description for the -d option.
       The format for the user audit criteria  display  is:  User
       Audit Criteria:
            user1 (uid1): all | none | events[,. . .]
            user2 (uid2): all | none | events[,. . .]

       (user  is  the  login  name and uid the user ID).  Set the
       system wide auditing criteria.  Any valid  event  type  or
       event  class  will  be  recorded regardless of the current
       user or object level criteria.  Set the auditing  criteria
       for  the  specified active user(s) or all users.  All pro-
       cesses belonging to the specified user(s) will have  their
       auditing information updated.

       If the MAC feature is installed the following command line
       options are also valid: The -m option is a modifier to the
       -d  option.   The object level audit criteria will be dis-
       played in the format: Object Level Audit Criteria:  all  |
       none | events[,. . .]
             levelmin - levelmax
             level  Set the object auditing criteria.  The events
       specified are to be audited for the  levels  currently  in
       effect.   Set  the  object  level  to be audited.  A valid
       level is one that is defined to the  system  [see  The  -l
       option may be used repeatedly to set multiple levels.  The
       maximum number of individual levels that can be audited is
       set  by  the system tunable (ADT_NLVLS).  Set the range of
       object levels to be audited.  At any time only one  object
       level  range  can be set.  A valid level range is one that
       is defined to the system [see and the maximum level  domi-
       nates  the  minimum  level.   The level range is inclusive
       therefore the levels specified as  the  option  arguments,
       levelmin and levelmax, are audited.

FFiilleess
       /etc/security/audit/classes

                                                                2

auditset(1M)                                         auditset(1M)

DDiiaaggnnoossttiiccss
       When invoked successfully, the auditset command exits with
       a value of zero (0).  If there are errors, it  exits  with
       one  of  the following values and prints the corresponding
       error message: usage: auditset . . .

       Invalid command  syntax.   invalid  security  level  level
       specified

       An invalid level was specified as an argument to the -l or
       -r options.  maximum security level does not dominate min-
       imum security level level-level"

       An  invalid  security level range was used as the argument
       to the -r option.  invalid option -o, -l, -r
       system service not installed
       usage: auditset . . .

       The MAC feature must be installed to use the -o,  -l,  and
       -r options.  system service not installed

       The audit package is not installed.  Permission denied

       Failure  because  of  insufficient  privilege.   opendir()
       failed for directory /proc

       Unable to obtain a list of the active users on the system.
       auditevt() failed AGETSYS, errno = errno

       A failure occurred while retrieving the system audit mask.
       auditevt() failed ACNTLVL, errno = errno

       A failure occurred while retrieving the object level audit
       mask.  auditevt() failed AGETLVL, errno = errno

       A failure occurred while retrieving the object level audit
       mask.  auditevt() failed AGETUSR, errno = errno

       A failure occurred while retrieving a user's  audit  mask.
       auditevt() failed ASETSYS, errno = errno

       A  failure  occurred  while setting the system audit mask.
       auditevt() failed ASETUSR, errno = errno

       A failure occurred while  setting  a  user's  audit  mask.
       auditevt() failed ASETLVL, errno = errno

       A  failure  occurred  while setting the object level audit
       mask.  auditctl() failed ASTATUS, errno = errno

       A failure occurred while retrieving the status  of  audit-
       ing.  unable to allocate space argvtostr() failed function
       name failed, errno = error

                                                                3

auditset(1M)                                         auditset(1M)

       Failure  occurred  while  accessing   level   information.
       lvlout() error, errno = error

       A  failure  occurred  while  accessing  level information.
       lvlin() error, errno = error

       A failure  occurred  while  accessing  level  information.
       LTDB is inaccessible

       Cannot open the Level Translation Database (LTDB).

       The following warning messages may be displayed: The argu-
       ment to the -u option contained  an  invalid  or  inactive
       user.   No  object level event type(s) or class(es) are in
       effect.  The total number of levels that can be audited is
       defined    by   the   tunable   parameter   ADT_NLVLS   in
       /etc/conf/mtune.d/audit.  If the level  to  be  set  would
       exceed this parameter, the system prints this warning mes-
       sage and continues processing the  remaining  options,  if
       any.   An  attempt was made to delete a level that was not
       set for auditing.

RReeffeerreenncceess
NNoottiicceess
       The auditset command sets audit criteria for users dynami-
       cally.   When  you  set audit criteria for a user with the
       -e,-u,-a options, the criteria are in effect only for that
       login  session.   If  the  user  logs  out or logs in from
       another terminal, the criteria are no  longer  in  effect.
       If  you  want to set audit criteria for all a user's login
       sessions, use either the useradd or usermod commands.

                                                                4

