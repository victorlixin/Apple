

runacct(1M)                                           runacct(1M)

SSyynnooppssiiss
       /usr/lib/acct/runacct [mmdd [state]]

DDeessccrriippttiioonn
       runacct  is the main daily accounting shell procedure.  It
       is normally initiated via cron.   runacct  processes  con-
       nect,  fee,  disk,  and process accounting files.  It also
       prepares summary files for prdaily  or  billing  purposes.
       runacct is distributed only to source code licensees.

       runacct  takes  care not to damage active accounting files
       or summary files in the event of errors.  It  records  its
       progress  by  writing descriptive diagnostic messages into
       active.  When an error is detected, a message  is  written
       to  /dev/console,  mail  (see is sent to root and adm, and
       runacct terminates.  runacct uses a series of  lock  files
       to  protect  against  re-invocation.   The  files lock and
       lock1 are used to  prevent  simultaneous  invocation,  and
       lastdate  is  used to prevent more than one invocation per
       day.

       runacct breaks its processing into  separate,  restartable
       states  using  statefile  to  remember the last state com-
       pleted.  It accomplishes this by writing  the  state  name
       into  statefile.   runacct  then looks in statefile to see
       what it has done and to determine what  to  process  next.
       States  are  executed  in the following order: Move active
       accounting files into working files.  Verify integrity  of
       wtmp  file, correcting date changes if necessary.  Produce
       connect session records in tacct.h format.   Convert  pro-
       cess  accounting  records  into tacct.h format.  Merge the
       connect and process accounting records.  Convert output of
       chargefee  into  tacct.h format and merge with connect and
       process accounting records.  Merge disk accounting records
       with  connect, process, and fee accounting records.  Merge
       the daily total accounting records in  daytacct  with  the
       summary       total       accounting       records      in
       /var/adm/acct/sum/tacct.  Produce command summaries.   Any
       installation dependent accounting programs can be included
       here.  Clean up temporary  files  and  exit.   To  restart
       runacct  after  a failure, first check the active file for
       diagnostics, then fix any corrupted data  files,  such  as
       pacct  or  wtmp.  The lock, lock1, and lastdate files must
       be removed before runacct can be restarted.  The  argument
       mmdd is necessary if runacct is being restarted, and spec-
       ifies the month and day for which runacct will  rerun  the
       accounting.   The  entry  point for processing is based on
       the contents of statefile; to override this,  include  the
       desired  state on the command line to designate where pro-
       cessing should begin.

FFiilleess
EExxaammpplleess
       To    start     runacct:     nohup     runacct     2     >

                                                                1

runacct(1M)                                           runacct(1M)

       /var/adm/acct/nite/fd2log  &  To  restart  runacct:  nohup
       runacct 0601 2 >> /var/adm/acct/nite/fd2log &  To  restart
       runacct at a specific state: nohup runacct 0601 MERGE 2 >>
       /var/adm/acct/nite/fd2log &

RReeffeerreenncceess
NNoottiicceess
       Normally it is not a good idea to restart runacct  in  the
       SETUP  state.  Run SETUP manually and restart via: runacct
       mmdd WTMPFIX If runacct failed in the PROCESS state remove
       the last ptacct file because it will not be complete.

                                                                2

