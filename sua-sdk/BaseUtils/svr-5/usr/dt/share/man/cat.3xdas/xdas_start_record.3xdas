

xdas_start_record(3xdas)                 xdas_start_record(3xdas)

SSyynnooppssiiss
       cc  [flag  ...]  file  ...   -Kthread -leels [library] ...
       #include <sys/xdas.h>

       OM_uint32 xdas_start_record(      OM_uint32 *minor_status,
            const            xdas_audit_ref_t           *das_ref,
            xdas_audit_desc_t           *audit_record_descriptor,
            const  OM_unit32  event_number,       const OM_uint32
       outcome,      const xdas_buffer_t  *initiator_information,
            const  xdas_buffer_t  *target_information,      const
       xdas_buffer_t *event_info);

DDeessccrriippttiioonn
       The xdas_start_record(3xdas) function is a member  of  the
       XDAS Event Submission API Option Conformance class.

       xdas_start_record(3xdas)  returns an audit_record_descrip-
       tor handle to the audit  record  to  the  caller.  If  the
       optional  parameters  are  not specified in the call, then
       the audit record is initialized but requires  fully  popu-
       lating by subsequent calls to

       If     the     optional    parameters    are    specified,
       xdas_start_record(3xdas) determines  whether  a  specified
       event  should  be  audited given the event_number, outcome
       and initiator_information supplied. If the event should be
       audited,  a  valid  audit_record_descriptor is returned to
       the caller. If the audit event does not  require  auditing
       then audit_record_descriptor is set to NULL.

       The caller must have the XDAS_AUDIT_SUBMIT authority.

       If successful, the function returns XDAS_S_COMPLETE.

       Although  several  parameters are optional in this call, a
       caller shall have populated all the parameters, even  when
       empty,   in   one   or   more   sequences   of   calls  to
       xdas_start_record(3xdas) and before a call to can be  suc-
       cessful.

   AArrgguummeennttss
       (Output) Provides additional information when the function
       returns XDAS_S_FAILURE.  (Input) A handle to the XDAS ser-
       vice,  obtained from a previous call to (Output) A pointer
       to an audit record, populated as defined by  the  optional
       input  parameters.  If  the  event  does  not  need  to be
       audited, a NULL pointer is returned.  (Optional input) The
       event_number  of the detected event.  (Optional input) The
       outcome  of  the  event  as  determined  by  the   caller.
       (Optional  input) The available information describing the
       initiator in the format required by the XDAS common  audit
       format.  (Optional input) Information on the target of the
       event in the format required by the XDAS common audit for-
       mat.   (Optional input) Information specific to the event.

                                                                1

xdas_start_record(3xdas)                 xdas_start_record(3xdas)

RReettuurrnn vvaalluueess
       The caller does not possess the required authority.   Suc-
       cessful  completion.   An implementation specific error or
       failure has occurred, such as missing required parameters,
       or  a  malloc  failure.  The audit service handle supplied
       does not point to the audit  service.   The  event  number
       specified is invalid.  The initiator information specified
       has a syntax error.  The outcome supplied is invalid.  The
       target  information  specified  has  a  syntax error.  The
       event information specified  is  invalid.   The  specified
       event  does  not need to be audited.  There is uncertainty
       as to whether the specified event requires auditing.

RReeffeerreenncceess

                                                                2

