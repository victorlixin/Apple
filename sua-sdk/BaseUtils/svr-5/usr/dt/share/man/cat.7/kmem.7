

kmem(7)                                                   kmem(7)

SSyynnooppssiiss
       #include <sys/ksym.h>

       int  ioctl(int  kmemfd,  MIOC_READKSYM,  struct mioc_rksym
       *rks);  int  ioctl(int  kmemfd,   MIOC_IREADKSYM,   struct
       mioc_rksym  *rks);  int  ioctl(int kmemfd, MIOC_WRITEKSYM,
       struct   mioc_rksym   *rks);   int    ioctl(int    kmemfd,
       MIOC_IWRITEKSYM, struct mioc_rksym *rks);

DDeessccrriippttiioonn
       When  used  with  a  valid  file  descriptor for /dev/kmem
       (kmemfd), these ioctl commands (see can be used to read or
       write  kernel  memory based on information provided in the
       mioc_rksym structure, which includes  the  following  mem-
       bers:       char *mirk_symname; /* symbol at whose address
       read will start */      void *mirk_buf;     /* buffer into
       which  data will be written */      size_t mirk_buflen; /*
       length (in bytes) of read buffer */

       The second argument to ioctl determines which  I/O  opera-
       tion  is being performed: Read mirk_buflen bytes of kernel
       memory starting  at  the  address  for  mirk_symname  into
       mirk_buf.   Read  sizeof(void  *)  bytes  of kernel memory
       starting at the address for mirk_symname and use  that  as
       the address from which to read mirk_buflen bytes of kernel
       memory into mirk_buf.  Write mirk_buflen bytes into kernel
       memory  starting  at  the  address  for  mirk_symname from
       mirk_buf.  Read sizeof(void  *)  bytes  of  kernel  memory
       starting  at  the address for mirk_symname and use that as
       the address from which to write mirk_buflen bytes of  ker-
       nel memory into mirk_buf.

RReettuurrnn vvaalluueess
       In  addition to the error conditions listed on these ioctl
       commands can fail for the following reasons:  kmemfd  open
       for  reading and this is MIOC_WRITEKSYM or kmemfd open for
       writing and this is  MIOC_READKSYM  Value  of  mirk_buflen
       results  in attempt to read outside kernel virtual address
       space, or the  third  argument  to  ioctl  is  an  invalid
       pointer,  or  an  invalid  pointer is given for the symbol
       name or buffer in the mioc_rksym structure Second argument
       to ioctl is invalid Symbol name is longer than MAXSYMNMLEN
       characters Symbol names not found in  the  running  kernel
       (including  loaded  modules)  kmemfd  open  on wrong minor
       device (that is, not /dev/kmem)

RReeffeerreenncceess

                                                                1

