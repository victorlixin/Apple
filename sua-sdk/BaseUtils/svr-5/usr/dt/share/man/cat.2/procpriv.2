

procpriv(2)                                           procpriv(2)

SSyynnooppssiiss
       #include <sys/types.h> #include <priv.h>

       int procpriv(int cmd, priv_t *privp, int nentries);

DDeessccrriippttiioonn
       The procpriv system call is used to add, remove, retrieve,
       count, or put the privileges associated with  the  calling
       process.   privp  is  a  pointer  to an array of privilege
       descriptors, each of which contains the privilege set  and
       identity of the requested privilege.  nentries is the num-
       ber of entries contained in privp.

       The recognized cmds  and  their  functions  are  described
       below:  Set the working privilege set for the current pro-
       cess based on the  privilege  descriptor(s)  contained  in
       privp.  All requested privileges not contained in the cur-
       rent maximum privilege set  are  ignored.   All  requested
       working privileges that are in the current maximum set are
       added to the working set.  If  any  argument  is  invalid,
       none  of  the  process  privileges  is changed.  Clear the
       working and maximum privilege sets for the current process
       based  on  the privilege descriptor(s) contained in privp.
       All requested privileges are removed from their respective
       sets.   The  working set is adjusted to be a subset of the
       resulting maximum set.  If any argument is  invalid,  none
       of the process privileges is changed.  Set the working and
       maximum privilege sets for the current  process  based  on
       the  privilege descriptor(s) contained in privp.  The set-
       ting is absolute.  The working set is  adjusted  to  be  a
       subset of the resulting maximum set.  Privileges contained
       in either privilege set that are not in the maximum set of
       the  calling  process  are  ignored.   If  any argument is
       invalid,  none  of  the  process  privileges  is  changed.
       Return in privp the working and maximum privilege sets for
       the current process in the form of privilege  descriptors.
       None  of  the  process  privileges is changed.  Return the
       number of privileges associated with the current  process.
       The privp and nentries arguments are ignored.  None of the
       process privileges is changed.

   RReettuurrnn vvaalluueess
       On success, procpriv  returns  the  number  of  privileges
       associated  with the current process (SETPRV, CLRPRV, PUT-
       PRV, GETPRV, CNTPRV).  On failure, procpriv returns -1 and
       sets errno to identify the error.

   EErrrroorrss
       In the following conditions, procpriv fails and sets errno
       to: cmd or privilege specified is invalid, or nentries  is
       less  than  0, or cmd is GETPRV and the process privileges
       exceeds nentries.

                                                                1

procpriv(2)                                           procpriv(2)

RReeffeerreenncceess
NNoottiicceess
   CCoonnssiiddeerraattiioonnss ffoorr tthhrreeaaddss pprrooggrraammmmiinngg
       Enhanced Security attributes are a characteristic  of  the
       containing process and are shared by sibling threads.

                                                                2

