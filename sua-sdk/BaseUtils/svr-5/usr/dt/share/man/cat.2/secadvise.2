

secadvise(2)                                         secadvise(2)

SSyynnooppssiiss
       #include <sys/secsys.h>

       int   secadvise(struct  obj_attr  *obj,  int  cmd,  struct
       sub_attr *sub);

DDeessccrriippttiioonn
       The secadvise system call is used to get  advisory  access
       information from the kernel.

       The  obj  argument  points  to  a structure containing the
       attributes for an object.  This structure is defined  with
       at  least  the  following  members:  uid_t uid; gid_t gid;
       mode_t mode; level_t lid;

       The level_t argument is ignored unless the Enhanced  Secu-
       rity Utilities are installed.

       The cmd argument determines the requested access.  The sub
       argument points to a structure containing  the  attributes
       for a subject.  The subject structure is retrieved through
       the I_S_RECVFD command of the ioctl system call.

       secadvise recognizes the following commands:  Returns  the
       size of the subject attributes structure.  The obj and sub
       arguments are ignored.  This command is provided  so  that
       future changes to the kernel can happen without recompila-
       tion of the application program.  Determines  whether  sub
       has  read  access  to  obj.   If this command succeeds, it
       returns 0 to the calling process.

       This call will fail, returning -1, if one or more  of  the
       following  is  true:  if  sub does not have read access to
       obj.  if obj or sub points outside the  allocated  address
       space  for  the process.  Determines whether sub has write
       access to obj.  If this command succeeds, it returns 0  to
       the calling process.

       This  call  will fail, returning -1, if one or more of the
       following is true: if sub does not have  write  access  to
       obj.   if  obj or sub points outside the allocated address
       space for the process.  Determines whether sub has execute
       access  to obj.  If this command succeeds, it returns 0 to
       the calling process.

       This call will fail, returning -1, if one or more  of  the
       following  is true: if sub does not have execute access to
       obj.  if obj or sub points outside the  allocated  address
       space for the process.

RReettuurrnn vvaalluueess
       Return   values  for  secadvise  depend  on  cmd  and  are
       described above.

                                                                1

secadvise(2)                                         secadvise(2)

       Errors for secadvise  depend  on  cmd  and  are  described
       above.

RReeffeerreenncceess

                                                                2

