

pam_set_data(3pam_api)                     pam_set_data(3pam_api)

SSyynnooppssiiss
       #include <security/pam_appl.h>

       int pam_set_data (
               pam_handle_t *pamh,
               const char *module_data_name,
               void *data,
               void  *(cleanup)(pam_handle_t  *pamh,  void *data,
       int pam_end_status));

DDeessccrriippttiioonn
       pam_set_data sets and modifies information  that  is  spe-
       cific  to a module. The information stored in the PAM han-
       dle, pamh,

       This function takes  the  following  arguments:  (In)  The
       authentication  handle returned by (In) The identifier for
       the module information that is to be set or changed.  This
       name must be unique for all services.  (In) The data value
       to be set.  (In) A function that calls to release the mem-
       ory  that was allocated to hold the data.  If data already
       exists for a given  module_data_name,  both  the  existing
       data and cleanup function are replaced.

RReettuurrnn vvaalluueess
       pam_set_data  returns  PAM_SUCCESS  if successful.  Other-
       wise, it returns one of the following error codes:  Buffer
       error.  System error.

                                                                1

