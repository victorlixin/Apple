

pam_get_mapped_authtok(3pam_api) pam_get_mapped_authtok(3pam_api)

SSyynnooppssiiss
       #include <security/pam_appl.h>

       int pam_get_mapped_authtok (
               pam_handle_t *pamh,
               const char *target_module_username,
               const char *target_module_type,
               const char *target_authn_domain,
               size_t *target_authtok_len,
               unsigned char **target_module_authtok);

DDeessccrriippttiioonn
       pam_get_mapped_authtok  retrieves  a  mapped  password for
       target_module_username after checking that the data in the
       PAM  handle,  pamh,  authorizes the calling user to obtain
       this information.  The  memory  allocated  to  target_mod-
       ule_authtok  should  be  freed as soon as the password has
       been used.  This function takes the  following  arguments:
       (In)  The  authentication  handle  returned by (In) Target
       username used to obtain a mapped  password.   (In)  Target
       authentication  type.   (In)  Target  domain  name. A null
       value specifies the default target domain.   (Out)  Target
       password length.  (Out) Target password.

RReettuurrnn vvaalluueess
       pam_get_mapped_authtok  returns PAM_SUCCESS if successful.
       Otherwise, it returns one of the  following  error  codes:
       Buffer error.  Conversation error.  Module domain not sup-
       ported for mapping.  Module type not  supported  for  map-
       ping.  An attempt to load a service module failed.  Access
       denied.  Reading or writing of data failed for mapping.  A
       service  module did not recognize a symbol.  System error.
       The service does not recognize the user.

                                                                1

