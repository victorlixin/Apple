

pam_acct_mgmt(3pam_api)                   pam_acct_mgmt(3pam_api)

SSyynnooppssiiss
       #include <security/pam_appl.h>

       int pam_acct_mgmt (pam_handle_t *pamh, int flags);

DDeessccrriippttiioonn
       pam_acct_mgmt  validates  a PAM account, usually after has
       authenticated the user.  It checks whether the account and
       its  password  have  expired,  and  also whether access is
       restricted at certain times.

       This function takes  the  following  arguments:  (In)  The
       authentication  handle returned by (In) One of the follow-
       ing flags may be set  to  control  the  operation  of  the
       account  management service: Do not generate any messages.
       Return  PAM_NEW_AUTHTOKEN_REQD  if  a  new  authentication
       token is required.

RReettuurrnn vvaalluueess
       pam_acct_mgmt  returns  PAM_SUCCESS if successful.  Other-
       wise, it returns one of the  following  error  codes:  The
       account  has expired.  A user's password has been too long
       expired.  Buffer error.  Conversation  error.   A  service
       module  returns  a null authentication token if the user's
       password  has  expired.  The  calling  application  should
       request  a new password from the user.  An attempt to load
       a service module failed.  Access denied.   Service  module
       error.  A service module did not recognize a symbol.  Sys-
       tem error.  The service does not recognize the user.

                                                                1

