

pam_authenticate_secondary(3papma_ma_paiu)thenticate_secondary(3pam_api)

SSyynnooppssiiss
       #include <security/pam_appl.h>

       int pam_authenticate_secondary (
               pam_handle_t *pamh,
               char *target_username,
               char *target_module_type,
               char *target_authn_domain,
               char *target_supp_data,
               unsigned char *target_module_authtok,
               int flags);

DDeessccrriippttiioonn
       pam_authenticate_secondary  authenticates  target_username
       with the secondary domain,  target_authn_domain.  This  is
       done  separately  from authenticating the user and setting
       up their session in the primary domain.  and are  used  to
       obtain   the   username   and  authentication  token  that
       pam_authenticate_secondary will  use  for  target_username
       and target_module_authtok.

       This  function  takes  the following arguments: (In) A PAM
       authentication handle returned by (In) The  username  that
       is  to  be  authenticated with the secondary domain.  (In)
       The type of authentication to be performed with  the  sec-
       ondary  domain.   (In)  The secondary domain that requires
       authentication.  (In) Supplementary  information  required
       by  the  authentication mechanism in the secondary domain.
       (In) An authentication token that is required by  the  the
       authentication  mechanism in the secondary domain.  Do not
       assume that target_module_authtok will have  been  cleared
       when  pam_authenticate_secondary returns.  (In) One of the
       following flags may be set to control the operation of the
       authentication  service:  Do  not  generate  any messages.
       Return PAM_AUTH_ERROR if the user's  authentication  token
       is null.

RReettuurrnn vvaalluueess
       pam_authenticate_secondary returns PAM_SUCCESS if success-
       ful.  Otherwise, it returns one  of  the  following  error
       codes:  The  user  could not be authenticated because they
       entered an incorrect token, or a null token was  submitted
       with  PAM_DISALLOW_NULL_AUTHTOK  set.  Buffer error.  Con-
       versation  error.   Insufficient  credentials  to   access
       authentication  data.  An attempt to load a service module
       failed.  Service module error.  A service module  did  not
       recognize  a  symbol.   System  error.  Permission denied.
       The service does not recognize the user.

                                                                1

