

icmp(7tcp)                                             icmp(7tcp)

SSyynnooppssiiss
       Programmer's  interface:  #include  <sys/types.h> #include
       <sys/socket.h>    #include     <sys/sockio.h>     #include
       <netinet/in.h>

       s = socket(AF_INET, SOCK_RAW, IPPROTO_ICMP);

       #include    <paths.h>    #include    <fcntl.h>    #include
       <netinet/in_systm.h>  #include   <netinet/ip.h>   #include
       <netinet/ip_icmp.h>  #include  <netinet/ip_var.h> #include
       <netinet/icmp_var.h>

       fd = open(_PATH_ICMP, flags);

DDeessccrriippttiioonn
       ICMPv4 is the error and control message (or device) proto-
       col  used by IPv4 and the Internet protocol family. It may
       be accessed through a raw socket  for  network  monitoring
       and  diagnostic functions.  ICMPv4 sockets are connection-
       less, and are normally used with the sendto  and  recvfrom
       calls;  the  call  may also be used to fix the destination
       for future packets (in which case the  or  and  or  system
       calls may be used).

       Outgoing   packets   automatically  have  an  IPv4  header
       prepended to them  (based  on  the  destination  address).
       Incoming  packets  are  received  with the IPv4 header and
       options intact.

       The ICMP driver can also be accessed by opening _PATH_ICMP
       directly.   Networking statistics can be gathered by issu-
       ing an ioctl directive to the driver.

       The  following  STREAMS   ioctl   requests,   defined   in
       <netinet/ip_var.h>,  are  supported  by  the  ICMP driver:
       Fetch the ICMP statistics structure. The  argument  passed
       to  the  I_STR call is a pointer to an icmpstat structure.
       To set the inpcb associated with that end-point as a  man-
       agement  inpcb (to distinguish it from others when network
       statistics are gathered).

DDiiaaggnnoossttiiccss
       A socket operation may fail  with  one  of  the  following
       errors  returned:  when  an  attempt  is  made to create a
       socket with a network address for which no network  inter-
       face  exists.   when trying to establish a connection on a
       socket which already has one, or when  trying  to  send  a
       datagram  with  the  destination address specified and the
       socket is already connected.  when the system runs out  of
       memory  for  an  internal data structure.  when the system
       runs out of STREAMS resources.   when  trying  to  send  a
       datagram, but no destination address is specified, and the
       socket has not been connected.  The errno is  set  to  the
       following  value  upon the failure of the ioctl operation:

                                                                1

icmp(7tcp)                                             icmp(7tcp)

       when an invalid argument is passed to the driver.

RReeffeerreenncceess
       on the manual page

       RFC 792, RFC 950

                                                                2

