

pam_sm_acct_mgmt(3pam_spi)             pam_sm_acct_mgmt(3pam_spi)

SSyynnooppssiiss
       #include <security/pam_appl.h> #include <security/pam_mod-
       ules.h>

       int pam_sm_acct_mgmt(
               pam_handle_t *pamh,
               int flags,
               int argc,
               const char **argv);

DDeessccrriippttiioonn
       pam_sm_acct_mgmt verifies that a  user  may  access  their
       account.   An  account management service module must pro-
       vide this function so that an authentication provider  can
       respond to an application invoking

       This  function  should  take the following arguments: (In)
       The authentication handle returned by (In) One of the fol-
       lowing  flags may be set to control the output of messages
       from the account management service: Do not  generate  any
       messages.   Return PAM_NEW_AUTHTOKEN_REQD if a new authen-
       tication token is required.  (In)  The  number  of  module
       options  defined  in  the  PAM configuration file.  (In) A
       vector of module options. A module should log  but  other-
       wise ignore an unrecognized option.

RReettuurrnn vvaalluueess
       pam_sm_acct_mgmt  should return PAM_SUCCESS if successful.
       Otherwise, it should return one  of  the  following  error
       codes:  The  account  has  expired.  A user's password has
       been too long expired.  Buffer error.  Conversation error.
       A  service  module  returns a null authentication token if
       the user's password has expired. The  calling  application
       should  request  a new password from the user.  An attempt
       to load a service module failed.  Access denied.   Service
       module  error.   A service module did not recognize a sym-
       bol.  System error.  The service does  not  recognize  the
       user.

                                                                1

