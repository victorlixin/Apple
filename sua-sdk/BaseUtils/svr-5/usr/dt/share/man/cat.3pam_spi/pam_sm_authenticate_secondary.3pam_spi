

pam_sm_authenticate_secondapraym(_3spma_ma_ustphie)nticate_secondary(3pam_spi)

SSyynnooppssiiss
       #include <security/pam_appl.h> #include <security/pam_mod-
       ules.h>

       int pam_authenticate_secondary (
               pam_handle_t *pamh,
               char *target_username,
               char *target_module_type,
               char *target_authn_domain,
               char *target_supp_data,
               unsigned char *target_module_authtok,
               int flags);

DDeessccrriippttiioonn
       pam_sm_authenticate_secondary verifies a  user's  identity
       in  a secondary sign-on domain based on information recov-
       ered from a mapping  module.   An  authentication  service
       module  must  provide this function so that an authentica-
       tion provider can respond to an application invoking

       This function should take the  following  arguments:  (In)
       The  authentication  handle  returned by (In) The username
       that is to be authenticated  with  the  secondary  domain.
       (In)  The  type of authentication to be performed with the
       secondary domain.  (In) The secondary domain that requires
       authentication.   (In)  Supplementary information required
       by the authentication mechanism in the  secondary  domain.
       (In)  An  authentication token that is required by the the
       authentication mechanism in the secondary domain.  This is
       usually obtained using (In) One of the following flags may
       be set to control the authentication service: Do not  gen-
       erate  any  messages.  Return PAM_AUTH_ERROR if the user's
       authentication token is null.

RReettuurrnn vvaalluueess
       pam_authenticate_secondary should  return  PAM_SUCCESS  if
       successful.   Otherwise,  it should return one of the fol-
       lowing error codes: The user could  not  be  authenticated
       because  they  entered an incorrect token, or a null token
       was submitted with PAM_DISALLOW_NULL_AUTHTOK set.   Buffer
       error.   Conversation  error.  Insufficient credentials to
       access authentication data.  Service module error.  A ser-
       vice  module  did  not  recognize a symbol.  System error.
       Permission denied.  The service  does  not  recognize  the
       user.

                                                                1

