

pam_sm_get_mapped_authtok(3pam_psapmi_)sm_get_mapped_authtok(3pam_spi)

SSyynnooppssiiss
       #include <security/pam_appl.h> #include <security/pam_mod-
       ules.h>

       int pam_sm_get_mapped_authtok (
               pam_handle_t *pamh,
               char *target_module_username,
               char *target_module_type,
               char *target_authn_domain,
               size_t *target_authtok_len,
               unsigned char **target_module_authtok,
               int argc,
               const char **argv);

DDeessccrriippttiioonn
       pam_sm_get_mapped_authtok  obtains   a   user's   password
       (authentication  token) for a secondary sign-on domain.  A
       mapping service module must provide this function so  that
       an  authentication  provider can respond to an application
       invoking Any implementation of this function should  clear
       the  returned  password from memory as soon as it has been
       used.  This function should take the following  arguments:
       (In)  The  authentication  handle  returned by (In) Target
       username used to obtain a mapped  password.   (In)  Target
       authentication  type.   (In)  Target  domain  name. A null
       value specifies the default target domain.   (Out)  Target
       password  length.  (Out) Target password.  (In) The number
       of module options defined in the PAM  configuration  file.
       (In)  A  vector of module options. A module should log but
       otherwise ignore an unrecognized option.

RReettuurrnn vvaalluueess
       pam_sm_get_mapped_authtok  should  return  PAM_SUCCESS  if
       successful.   Otherwise,  it should return one of the fol-
       lowing error codes:  Buffer  error.   Conversation  error.
       Module domain not supported for mapping.  The service mod-
       ule is ignored whatever control flag is set.  Module  type
       not supported for mapping.  Access denied.  Service module
       error.  System error.  The service does not recognize  the
       user.

                                                                1

