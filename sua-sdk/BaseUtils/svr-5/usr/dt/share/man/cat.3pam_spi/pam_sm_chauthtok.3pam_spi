

pam_sm_chauthtok(3pam_spi)             pam_sm_chauthtok(3pam_spi)

SSyynnooppssiiss
       #include <security/pam_appl.h> #include <security/pam_mod-
       ules.h>

       int pam_sm_chauthtok(
               pam_handle_t *pamh,
               const int flags,
               int argc,
               const char **argv);

DDeessccrriippttiioonn
       pam_sm_chauthtok updates a user's password (authentication
       token).   An  password management service module must pro-
       vide this function so that an authentication provider  can
       respond to an application invoking

       pam_sm_chauthtok  changes an authentication token (or pre-
       pares it to be changed in  some  authentication  schemes).
       It  may  prompt the user repeatedly using the conversation
       functions to ensure that the entered  password  is  suffi-
       ciently strong.

       pam_sm_chauthtok  should obtain PAM_AUTHTOK and PAM_OLDAU-
       THTOK by invoking If both PAM_AUTHTOK  and  PAM_OLDAUTHTOK
       are  null, pam_sm_chauthtok should set their values to the
       user-specified old and new passwords.

       This function should take the  following  arguments:  (In)
       The  authentication  handle returned by (In) The following
       flags may be set to control the password  management  ser-
       vice:  Do  not generate any messages.  Update only aged or
       expired passwords and return PAM_IGNORE  for  non-aged  or
       unexpired  passwords.  Otherwise,  update  all  passwords.
       Perform only preliminary checks for  the  availability  of
       necessary  local  or  remote services. Do not update pass-
       words.  If a problem is found which is  unlikely  to  per-
       sist,  the  module  should  return the PAM_TRY_AGAIN error
       which tells the application to try again. As soon  as  all
       the  relevant password management modules succeed in pass-
       ing the preliminary check, they  should  be  called  again
       with PAM_UPDATE_AUTHTOK set.

       This  flag is not set at the same time as PAM_UPDATE_AUTH-
       TOK.  Update password.

       This flag is not set at the same time as PAM_PRELIM_CHECK.
       (In)  The number of module options defined in the PAM con-
       figuration file.  (In) A vector of module options. A  mod-
       ule  should  log  but  otherwise  ignore  an  unrecognized
       option.

RReettuurrnn vvaalluueess
       pam_sm_chauthtok should return PAM_SUCCESS if  successful.
       Otherwise,  it  should  return  one of the following error

                                                                1

pam_sm_chauthtok(3pam_spi)             pam_sm_chauthtok(3pam_spi)

       codes: Aging of authentication tokens is disabled.  Updat-
       ing  the  authentication token failed.  The authentication
       token is unavailable because access  to  it  is  locked  .
       Authentication information is unobtainable.  Buffer error.
       Conversation error.  The service module is  ignored  what-
       ever  control flag is set.  Access denied.  Service module
       error.  System error.  Failure of the  prelimary  password
       check.  The password is not updated but retry is possible.
       The password service does not recognize the user.

                                                                2

