authenticateuser(2)                                 authenticateuser(2)

  aauutthheennttiiccaatteeuusseerr(())

  NNAAMMEE

    authenticateuser() - validate user information

  SSYYNNOOPPSSIISS

    #include <interix/security.h>

    int authenticateuser (const struct usersec userdata)

  DDEESSCCRRIIPPTTIIOONN

    The _aa_uu_tt_hh_ee_nn_tt_ii_cc_aa_tt_ee_uu_ss_ee_rr(2) function validates the data in the data structure
    userdata. It returns 1 if the information is valid and 0 if it is not.
    This function is often used to validate information before calling one of
    the exec_asuser functions.

    Note that this function is deprecated in favor of the call _ss_ee_tt_uu_ss_ee_rr(2) with
    the command flag SU_CHECK.

    The userdata argument is a user security structure, ssttrruucctt uusseerrsseecc, which
    is defined in <<sseeccuurriittyy..hh>>:

    struct usersec {
       char * user;
       char * domain;
       char * password;
       int logontype;          /* Defaults to 0 */
       int logonprovider;      /* Defaults to 0 */
    };

    The uusseerr points to the user's logon name.

    The ddoommaaiinn points to the user's domain.

    The ppaasssswwoorrdd points to the user's password.

    The llooggiinnttyyppee and llooggoonnpprroovviiddeerr members are reserved for future use; for
    now, they should left at the default value of 0.

  RREETTUURRNN VVAALLUUEESS

    If the information in the ssttrruucctt uusseerrsseecc structure is authentic and valid,
    _aa_uu_tt_hh_ee_nn_tt_ii_cc_aa_tt_ee_uu_ss_ee_rr(2) returns 1. Otherwise, it returns 0 and sets errno to
    indicate the error.

  EERRRROORRSS

    [EFAULT]
        The userdata parameter is not in a valid part of the user address
        space.

    [EINVAL]
        One of the members of the structure was invalid, possibly too long.

    [ENOMEM]
        Not enough memory.

    [EPERM]
        The user-domain-password combination is invalid.

  SSEEEE AALLSSOO

    _e_x_e_c___a_s_u_s_e_r(2)

    _s_e_t_u_s_e_r(2)

  UUSSAAGGEE NNOOTTEESS

    The aauutthheennttiiccaatteeuusseerr function is thread safe.

    The aauutthheennttiiccaatteeuusseerr function is not async-signal safe.

