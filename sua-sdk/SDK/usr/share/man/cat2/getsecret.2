getsecret(2)                                               getsecret(2)

  ggeettsseeccrreett

  NNAAMMEE

    getsecret(), setsecret - store and retrieve data in Windows LSA secret
    area

  SSYYNNOOPPSSIISS

    #include <interix/security.h>

    int getsecret(char *keyname, void *keyvalue, int valuelen);
    int setsecret(char *keyname, void *keyvalue, int keyvaluelen);

  DDEESSCCRRIIPPTTIIOONN

    The sseettsseeccrreett(2) function stores user-specified data in the Windows Local
    Security Authority (LSA) secret area. The keyvaluelen argument specifies
    the number of bytes in keyvalue to be stored in the secret area, and
    keyname identifies the area for subsequent retrieval. If the LSA secret
    area already has data identified by keyname, the data is overwritten if
    the call to sseettsseeccrreett() is successful.

    The ggeettsseeccrreett(2) function retrieves the value previously stored in the
    area identified by keyname and stores it in the buffer referenced by the
    keyvalue argument. The valuelen argument specifies the length of the
    keyvalue buffer.

    The maximum length of the keyname buffer is 128 bytes. Also, when
    retrieving a value, the key passed to ggeettsseeccrreett() must match exactly the
    key passed to sseettsseeccrreett() when storing the value, including case.

    Both of these functions must be called by users with local or domain
    administrator rights or system rights.

  RREETTUURRNN VVAALLUUEESS

    The sseettsseeccrreett() function returns 0 on success. The ggeettsseeccrreett() function
    returns the number of bytes returned in keyvalue. On failure, both
    functions return -1 and set errno to indicate the error.

  EERRRROORRSS

    Both of these functions can fail for the following reasons:

    [EFAULT]
        The system detected an invalid address when attempting to use an
        argument of a call.

    [ENOMEM]
        Not enough memory is available to perform the operation.

    [E2SMALL]
        The data stored in the area identified by keyname is larger than the
        buffer referenced by keyvalue.

    The ggeettsseeccrreett() function can fail for the following reason:

    [E2BIG]
        The keyname or keyvalue buffer is larger than allowed.

    The sseettsseeccrreett() function can fail for the following reason:

    [ENOENT]
        The LSA secret area does not have data stored in an area identified by
        the string in keyname.

  UUSSAAGGEE NNOOTTEESS

    All of these functions are thread safe.

    None of these functions are async-signal safe.

